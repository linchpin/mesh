!function(a,b){"use strict";a.widget("vanderlee.limitslider",a.ui.slider,{options:a.extend({classEven:"ui-slider-handle-even",classOdd:"ui-slider-handle-odd",gap:b,left:b,right:b,limit:b,limits:b,ranges:[],title:!1,label:!1},a.ui.slider.prototype.options),_create:function(){this.options.values||(this.options.values=[this.options.value]),a.ui.slider.prototype._create.call(this),a(this.element).addClass("ui-limitslider"),this._renderRanges(),this._renderLabels(),this._renderTitles()},_renderTitle:function(b){if(this.options.title){var c=this.options.values[b];a(this.handles[b]).attr("title",a.isFunction(this.options.title)?this.options.title(c,b):c).addClass(this.options[b%2?"classEven":"classOdd"])}},_renderTitles:function(b){if(this.options.title){var c=this;a.each(this.options.values,function(a){c._renderTitle(a)})}},_renderLabel:function(b){if(this.options.label){var c=this.options.values[b],d=a("<div>").css({"text-align":"center","font-size":"75%",display:"table-cell","vertical-align":"middle"}).html(a.isFunction(this.options.label)?this.options.label(c,b):c);a(this.handles[b]).html(d).css({"text-decoration":"none",display:"table"})}},_renderLabels:function(){if(this.options.label){var b=this;a.each(this.options.values,function(a){b._renderLabel(a)})}},_renderRanges:function(){var b,c,d,e,f=this.options,g=f.values,h=function(a){return 100*(a-f.min)/(f.max-f.min)};for(a(".ui-slider-range",this.element).remove(),b=0;b<=g.length;++b){var i,e=f.ranges[b];e&&(c=h(0==b?f.min:g[b-1]),d=h(b<g.length?g[b]:f.max),i=a("<div/>").addClass("ui-slider-range ui-widget-header").css("width",d-c+"%"),e.styleClass&&i.addClass(e.styleClass),0==c?i.addClass("ui-slider-range-min"):100==d?i.addClass("ui-slider-range-max"):i.css("left",c+"%"),a(this.element).prepend(i))}},_slide:function(b,c,d){this.options.left&&(d=Math.max(d,this.options.left)),this.options.right&&(d=Math.min(d,this.options.right)),this.options.limit&&(d=Math.max(d,this.options.limit[0]),d=Math.min(d,this.options.limit[1])),this.options.limits&&this.options.limits[c]&&(d=Math.max(d,this.options.limits[c][0]),d=Math.min(d,this.options.limits[c][1])),(this.options.gap||0===this.options.gap)&&(c>0&&(d=Math.max(d,this.options.values[c-1]+this.options.gap)),c<this.options.values.length-1&&(d=Math.min(d,this.options.values[c+1]-this.options.gap))),a.ui.slider.prototype._slide.call(this,b,c,d)},_change:function(b,c){a.ui.slider.prototype._change.call(this,b,c),this._renderRanges(),this._renderLabel(c),this._renderTitle(c)},insert:function(a,c,d,e){var f,g,h=this.options.values.length;return a=null===a||"undefined"==typeof a?h:Math.max(0,Math.min(a,h)),"undefined"==typeof c&&(f=0>=a?this.options.min:this.options.values[a-1],g=a>=h?this.options.max:this.options.values[a],c=Math.round(.5*(f+g))),this.options.values.splice(a,0,c),this.options.ranges&&this.options.ranges.splice(a,0,d||!1),this.options.limits&&this.options.limits.splice(a,0,d||b),this._create(),this.element.trigger("slide",[a,c]),this},remove:function(a,b){var c=this.options.values.length-1;return b=Math.max(1,b||1),c>b-1&&(a=null===a||"undefined"==typeof a?c+1-b:Math.max(0,Math.min(a,c)),this.options.values.splice(a,b),this.options.ranges&&this.options.ranges.splice(a,b),this.options.limits&&this.options.limits.splice(a,b),this._create()),this}})}(jQuery);var mesh=mesh||{};mesh.pointers=function(a){var b=0;return{show_pointer:function(){if("undefined"!=typeof mesh_data.wp_pointers){var c=mesh_data.wp_pointers.pointers[b],d=a.extend(c.options,{close:function(){a.post(ajaxurl,{pointer:c.pointer_id,action:"dismiss-wp-pointer"}),b++,b<mesh_data.wp_pointers.pointers.length&&mesh.pointers.show_pointer()}});a(c.target).pointer(d).pointer("open")}}}}(jQuery);var mesh=mesh||{};mesh.blocks=function(a){var b,c,d=a("body");return{init:function(){b=mesh.blocks,c=mesh.admin,"post"===mesh_data.screen&&(d.on("click",".mesh-block-featured-image-trash",b.remove_background).on("click",".mesh-block-featured-image-choose",b.choose_background).on("click.OpenMediaManager",".mesh-block-featured-image-choose",b.choose_background).on("click",".mesh-clean-edit:not(.title-input-visible)",b.show_field).on("blur",".mesh-clean-edit-element:not(select)",b.hide_field).on("click",".close-title-edit",b.hide_field).on("click",".slide-toggle-element",b.slide_toggle_element).on("change",".mesh-column-offset",b.display_offset),b.setup_resize_slider(),b.setup_sortable())},setup_sortable:function(){var c=[];a(".mesh-editor-blocks .mesh-row").sortable({axis:"x",cursor:"move",cursorAt:{left:0},distance:20,handle:".the-mover",items:".mesh-section-block",tolerance:"pointer",create:function(b,c){a(".mesh-editor-blocks .fade-in-on-create").fadeIn("slow")},start:function(b,d){var e=a(b.target),f=e.find(".column-slider");f.fadeOut("fast"),a(".mesh-section-block:not(.ui-sortable-placeholder)",this).each(function(){c.push(a(this).attr("class"))})},stop:function(b,c){var d=a(b.target),e=d.find(".column-slider");e.fadeIn("slow")},update:function(d,e){var f=a(this),g=a(d.target),h=g.parents(".mesh-section"),i=h.attr("data-mesh-section-id"),j=f.find(".mesh-section-block");j.each(function(b){var d=a(this);d.removeAttr("class").addClass(c[b]),d.find(".block-menu-order").val(b)}),b.rerender_blocks(h.find(".wp-editor-area")),b.save_order(i,d,e),b.setup_sortable()}})},change_block_widths:function(b,c){var d=a(b.target),e=d.parent().parent().parent().find(".mesh-editor-blocks").find(".mesh-row:first .columns").addClass("dragging"),f=e.length,g=12,h=[],i=c.values,j={post_id:parseInt(mesh_data.post_id),section_id:parseInt(d.closest(".mesh-section").attr("data-mesh-section-id")),blocks:{}};if(3==f)for(var k=0;f>=k;k++)switch(k){case 0:h.push(i[k]);break;case 1:h.push(i[k]-i[0]);break;case 2:h.push(g-i[1])}2==f&&(h.push(i[0]),h.push(g-i[0])),e.removeClass(function(a,b){return(b.match(/\mesh-columns-\d+/g)||[]).join(" ")}).each(function(b){var c=a(this),d=parseInt(c.find(".block").attr("data-mesh-block-id")),e=c.find(".column-width"),f=c.find(".mesh-column-offset"),g=f.val(),i=parseInt(h[b]),k=i-3;f.children("option").remove();for(var l=0;k>=l;l++)f.append(a("<option></option>").attr("value",l).text(l));g>k?f.val(0).trigger("change"):f.val(g).trigger("change"),c.addClass("mesh-columns-"+i),d&&h[b]&&(e.val(i),j.blocks[d.toString()]=i)})},setup_resize_slider:function(){a(".column-slider").addClass("ui-slider-horizontal").each(function(){var c=a(this),d=parseInt(c.attr("data-mesh-blocks")),e=d>2,f=a.parseJSON(c.attr("data-mesh-columns")),g={range:e,min:0,max:12,step:1,left:3,right:9,gap:3,start:function(){c.css("z-index",1e3)},stop:function(){c.css("z-index","").find(".ui-slider-handle").css("z-index",1e3)},slide:b.change_block_widths};f&&(g.value=f[0]),3===d&&(f[1]=f[0]+f[1],f.pop(),g.values=f,g.value=null),c.limitslider(g)})},rerender_blocks:function(b){b.each(function(){var b,c=a(this).prop("id"),d=[],e=[];if("undefined"!=typeof tinymce){parseInt(tinymce.majorVersion)>=4&&tinymce.execCommand("mceRemoveEditor",!1,c);var f=a(this).closest(".block-content");if("undefined"==typeof tinyMCEPreInit.mceInit[c]){b="content";var g=a(this).closest(".block-content").html();if(g=g.replace(new RegExp('id="'+b+'"',"g"),'id="'+c+'"'),f.html(g),!b||"undefined"==typeof tinyMCEPreInit.mceInit[b])return;d=a.extend(!0,{},tinyMCEPreInit.mceInit[b]),d.body_class=d.body_class.replace(b,c),d.selector=d.selector.replace(b,c),d.wp_skip_init=!1,d.plugins="lists,media,paste,tabfocus,wordpress,wpautoresize,wpeditimage,wpgallery,wplink,wptextpattern,wpview",d.block_formats="Paragraph=p; Heading 3=h3; Heading 4=h4",d.toolbar1="bold,italic,bullist,numlist,hr,alignleft,aligncenter,alignright,alignjustify,link,wp_adv ",d.toolbar2="formatselect,underline,strikethrough,forecolor,pastetext,removeformat ",d.toolbar3="",d.toolbar4="",tinyMCEPreInit.mceInit[c]=d}try{"html"!==mesh.blocks.mode_enabled(this)&&(parseInt(tinymce.majorVersion)>=4&&tinymce.execCommand("mceRemoveEditor",!1,c),a(this).closest(".wp-editor-wrap").on("click.wp-editor",function(){this.id&&(window.wpActiveEditor=this.id.slice(3,-5))}))}catch(h){console.log(h)}try{b="content",b&&"undefined"!=typeof tinyMCEPreInit.qtInit[b]&&(e=a.extend(!0,{},tinyMCEPreInit.qtInit[b]),e.id=e.id.replace(b,c),tinyMCEPreInit.qtInit[c]=e,e.buttons="strong,em,link,block,img,ul,ol,li","undefined"!=typeof quicktags&&quicktags(tinyMCEPreInit.qtInit[c]),"undefined"!=typeof QTags&&QTags._buttonsInit())}catch(h){console.log(h)}f.find(".switch-tmce").trigger("click")}}),"undefined"!=typeof mesh.integrations.yoast&&mesh.integrations.yoast.addMeshSections()},mode_enabled:function(b){return a(b).closest(".html-active").length?"html":"tinymce"},save_order:function(b,c,d){var e=(a(".mesh-reorder-spinner"),[]);a("#mesh-sections-editor-"+b).find(".block").each(function(){e.push(a(this).attr("data-mesh-block-id"))})},choose_background:function(b){b.preventDefault(),b.stopPropagation();var d=a(this),e=d.parents(".block"),f=parseInt(e.attr("data-mesh-block-id")),g="mesh-background-select-"+f,h=d.attr("data-mesh-block-featured-image");return c.media_frames=c.media_frames||[],c.media_frames[g]?(c.media_frames[g].uploader.uploader.param("mesh_upload","true"),void c.media_frames[g].open()):(c.media_frames[g]=wp.media.frames.media_frames=wp.media({className:"media-frame mesh-media-frame",frame:"select",multiple:!1,title:mesh_data.strings.select_block_bg,button:{text:mesh_data.strings.select_bg}}),c.media_frames[g].on("open",function(){var a=c.media_frames[g].state().get("selection");a.add(wp.media.attachment(h))}),c.media_frames[g].on("select",function(){var b=c.media_frames[g].state().get("selection").first().toJSON(),e=(a("<span />",{"class":"dashicons dashicons-edit"}),a("<a/>",{"data-mesh-section-featured-image":"",href:"#","class":"mesh-block-featured-image-trash dashicons-before dashicons-dismiss"}));a.post(ajaxurl,{action:"mesh_update_featured_image",mesh_section_id:parseInt(f),mesh_image_id:parseInt(b.id),mesh_featured_image_nonce:mesh_data.featured_image_nonce},function(a){-1!=a&&(h=b.id,d.html('<img src="'+b.url+'" />').attr("data-mesh-block-featured-image",parseInt(b.id)).after(e))})}),void c.media_frames[g].open())},remove_background:function(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=c.parents(".block"),e=parseInt(d.attr("data-mesh-block-id"));a.post(ajaxurl,{action:"mesh_update_featured_image",mesh_section_id:parseInt(e),mesh_featured_image_nonce:mesh_data.featured_image_nonce},function(a){-1!=a&&(c.prev().text(mesh_data.strings.add_image),c.remove())})},show_field:function(b){b.preventDefault(),b.stopPropagation();var c=a(this);c.parents(".mesh-postbox").hasClass("closed")||a(this).addClass("title-input-visible")},hide_field:function(b){b.preventDefault(),b.stopPropagation(),a(this).parent().removeClass("title-input-visible")},slide_toggle_element:function(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=c.data("toggle");a(d).slideToggle("fast"),c.toggleClass("toggled")},display_offset:function(b){var c=a(this).val(),d=a(this).parents(".block-header").next(".block-content");d.removeClass("mesh-has-offset mesh-offset-1 mesh-offset-2 mesh-offset-3 mesh-offset-4 mesh-offset-5 mesh-offset-6 mesh-offset-7 mesh-offset-8 mesh-offset-9"),parseInt(c)&&d.addClass("mesh-has-offset mesh-offset-"+c)},setup_drag_drop:function(){a(".mesh-editor-blocks .block").draggable({appendTo:"body",helper:function(b){var c=a(this),d=c.width();return $clone=c.clone().width(d).css("background","#fff"),$clone.find("*").removeAttr("id"),$clone},revert:!0,zIndex:1e3,handle:".the-mover",iframeFix:!0,start:function(a,b,c){}}),a(".block").addClass("ui-widget ui-widget-content ui-helper-clearfix").find(".block-header").addClass("hndle ui-sortable-handle").prepend("<span class='block-toggle' />"),a(".drop-target").droppable({accept:".block:not(.ui-sortable-helper)",activeClass:"ui-state-hover",hoverClass:"ui-state-active",handle:".block-header",revert:!0,drop:function(c,d){var e=a(this),f=d.draggable,g=d.draggable.parent(),h=a(c.target),i=h.find(".block"),j=h.parents(".mesh-section"),k=j.attr("data-mesh-section-id");return f.css({top:"",left:""}),e.append(f),g.append(i),b.rerender_blocks(j.find(".wp-editor-area")),b.save_order(k,c,d),b.setup_drag_drop(),!1}})}}}(jQuery);var mesh=mesh||{};mesh.templates=function(a){var b,c,d=a("body"),e=a("#mesh-template-welcome-panel");return{init:function(){b=mesh.templates,e.find(".mesh-template-welcome-panel-close").on("click",function(a){a.preventDefault(),e.addClass("hidden"),b.updateWelcomePanel(0)}),"post"===mesh_data.screen&&(c=mesh.blocks,d.on("click",".mesh-select-template",b.select_template).on("click",".mesh-template-layout",b.select_layout).on("click",".mesh-template-start",b.display_template_types).on("click",".mesh-template-change-type",b.change_template_type).on("click",".mesh-template-remove",b.remove_template))},warn_on_save:function(a){a.preventDefault(),a.stopPropagation();var c=confirm(mesh_data.strings.confirm_template_section_update);!0!==c&&b.applyTemplateChanges()},applyTemplateChanges:function(){a.post(ajaxurl,{action:"mesh_apply_template_changes",mesh_post_id:mesh_data.post_id,mesh_template_id:template,mesh_template_type:template_type,mesh_choose_template_nonce:mesh_data.choose_template_nonce},function(a){})},updateWelcomePanel:function(b){a.post(ajaxurl,{action:"mesh_template_update_welcome_panel",visible:b,meshtemplatepanelnonce:a("#mesh-templates-welcome-panel-nonce").val()})},remove_template:function(a){},change_template_type:function(b){b.preventDefault(),b.stopPropagation(),a.post(ajaxurl,{action:"mesh_change_template_type",mesh_post_id:mesh_data.post_id,mesh_template_type:"starter",mesh_choose_template_nonce:mesh_data.choose_template_nonce},function(b){if(b){var d=a(b),e=d.find(".wp-editor-area"),f=a(".empty-sections-message"),g=a(".mesh-main-ua-row"),h=a("#mesh-container");h.html("").append(d.children()),f.length&&(f.fadeOut("fast"),g.fadeIn("fast"));var i=a(".mesh-section",h);i.length>1&&a(".mesh-section-reorder").removeClass("disabled"),c.setup_resize_slider(),c.setup_sortable(),c.rerender_blocks(e),c.$sections=a(".mesh-section",a("#mesh-sections-container"))}})},display_template_types:function(a){a.preventDefault(),a.stopPropagation(),b.select_template_type(a)},select_template_type:function(b){b.preventDefault(),b.stopPropagation();var d=a(this),e=a(".mesh-template:checked").val(),f=d.attr("data-template-type");a.post(ajaxurl,{action:"mesh_choose_template",mesh_post_id:mesh_data.post_id,mesh_template_id:e,mesh_template_type:f,mesh_choose_template_nonce:mesh_data.choose_template_nonce},function(b){if(b){var d=a(b),e=d.find(".wp-editor-area"),f=a(".empty-sections-message"),g=a(".mesh-main-ua-row"),h=a("#mesh-sections-container");h.append(d),f.length&&(f.fadeOut("fast"),g.fadeIn("fast"));var i=a(".mesh-section",a("#mesh-container"));i.length>1&&a(".mesh-section-reorder").removeClass("disabled"),c.setup_resize_slider(),c.setup_sortable(),c.rerender_blocks(e),c.$sections=a(".mesh-section",h)}})},select_layout:function(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=a(".mesh-template-layout");d.removeClass("active").removeProp("checked"),c.addClass("active").find(".mesh-template").prop("checked","checked")},select_template:function(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=c.siblings(".spinner");return c.hasClass("disabled")?!1:(d.addClass("is-active"),void a.post(ajaxurl,{action:"mesh_list_templates",mesh_post_id:mesh_data.post_id,mesh_choose_template_nonce:mesh_data.choose_template_nonce},function(b){if(b){var c=a(b);a("#mesh-description").html("").append(c),d.removeClass("is-active")}else d.removeClass("is-active")}))}}}(jQuery);var mesh=mesh||{};mesh.integrations=mesh.integrations||{},mesh.admin=function(a){var b,c,d,e,f,g,h=a("body"),i=(a("document"),a(".mesh-section-reorder")),j=a(".mesh-section-add"),k=a(".mesh-section-collapse"),l=a(".mesh-section-expand"),m=a("#mesh-container"),n=a("#mesh-sections-container"),o=a("#mesh-description"),p=a("[data-equalizer]"),q=[];return{init:function(){("post"===mesh_data.screen||"edit"===mesh_data.screen||"settings_page_mesh"===mesh_data.screen)&&("edit"===mesh_data.screen&&(f=mesh.templates,f.init()),c=mesh.admin,d=mesh.blocks,e=mesh.pointers,f=mesh.templates,h.on("click",".mesh-section-add",c.add_section).on("click",".mesh-section-remove",c.remove_section).on("click",".mesh-section-reorder",c.reorder_sections).on("click",".mesh-save-order",c.save_section_order).on("click",".mesh-featured-image-trash",c.remove_background).on("click",".mesh-section-expand",c.expand_all_sections).on("click",".mesh-section-collapse",c.collapse_all_sections).on("click",".mesh-featured-image-choose",c.choose_background).on("click.OpenMediaManager",".mesh-featured-image-choose",c.choose_background).on("click",".mesh-trash-extra-blocks",c.trash_extra_blocks).on("click",".mesh-section-update",c.section_save).on("click",".mesh-section-save-draft",c.section_save_draft).on("click",".mesh-section-publish",c.section_publish).on("change",".mesh-choose-layout",c.choose_layout).on("keypress",".mesh-clean-edit-element",c.prevent_submit).on("keyup",".mesh-clean-edit-element",c.change_input_title).on("change","select.mesh-clean-edit-element",c.change_select_title).on("change","#mesh-css_mode",c.display_foundation_options),a(document).on("postbox-toggled",{event:event},c.expand_section),b=a(".mesh-section"),b.length<=1&&i.addClass("disabled"),p.length&&p.each(c.mesh_equalize),d.init(),e.show_pointer(0),f.init(),c.setup_notifications(m),c.display_foundation_options())},setup_notifications:function(b){b.find(".notice.is-dismissible").each(function(){var b=a(this),c=a('<button type="button" class="notice-dismiss"><span class="screen-reader-text"></span></button>'),d=commonL10n.dismiss||"";c.find(".screen-reader-text").text(d),b.append(c),c.on("click.wp-dismiss-notice",function(c){c.preventDefault(),a.post(ajaxurl,{action:"mesh_dismiss_notification",mesh_notification_type:b.attr("data-type"),_wpnonce:mesh_data.dismiss_nonce},function(a){}),b.fadeTo(100,0,function(){a(this).slideUp(100,function(){a(this).remove()})})})})},expand_section:function(b,c){var e=a(c),f=e.find(".wp-editor-area");e.hasClass("closed")||d.rerender_blocks(f)},expand_all_sections:function(d){d.preventDefault(),d.stopPropagation(),b.each(function(){var b=a(this).find(".handlediv");"true"!=b.attr("aria-expanded")&&(b.trigger("click"),c.expand_section(d,a(this)))})},collapse_all_sections:function(b){"undefined"!=typeof b&&(b.preventDefault(),b.stopPropagation()),n.find(".handlediv").each(function(){var b=a(this);("true"==b.attr("aria-expanded")||b.hasClass("toggled"))&&b.trigger("click")})},toggle_collapse:function(b){var d,e=a(this),f=e.parent(".postbox"),g=f.attr("id");f.toggleClass("closed"),d=!f.hasClass("closed"),e.hasClass("handlediv")?e.attr("aria-expanded",d):e.closest(".postbox").find("button.handlediv").attr("aria-expanded",d),"press-this"!==postboxes.page&&postboxes.save_state(postboxes.page),g&&(!f.hasClass("closed")&&a.isFunction(postboxes.pbshow)?postboxes.pbshow(g):f.hasClass("closed")&&a.isFunction(postboxes.pbhide)&&postboxes.pbhide(g)),c.expand_section(b,f.closest(".mesh-section"))},choose_layout:function(b){b.preventDefault(),b.stopPropagation();var e=a(this),f=a(this).val(),g=e.siblings(".spinner"),h=e.parents(".mesh-section"),i=h.attr("data-mesh-section-id"),j=h.find(".mesh-section-meta").find(".mesh-more-section-options"),k=j.hasClass("toggled");return e.hasClass("disabled")?!1:(g.addClass("is-active"),c.disable_controls(h),void a.post(ajaxurl,{action:"mesh_choose_layout",mesh_post_id:mesh_data.post_id,mesh_section_id:i,mesh_section_layout:f,mesh_choose_layout_nonce:mesh_data.choose_layout_nonce},function(b){if(b){var e,h=a(b),j=a("#mesh-section-"+i);e=j.find(".wp-editor-area"),e.each(function(){parseInt(tinymce.majorVersion)>=4&&tinymce.execCommand("mceRemoveEditor",!1,a(this).prop("id"))}),h.find(".mesh-choose-layout").val(f),j.find(".inside").html("").append(h),k&&(j.find(".mesh-more-section-options").addClass("toggled"),j.find(".mesh-section-meta-dropdown").removeClass("hide").show()),e=j.find(".wp-editor-area"),d.setup_resize_slider(),d.setup_sortable(),d.rerender_blocks(e)}c.enable_controls(j),g.removeClass("is-active")}))},add_section:function(e){e.preventDefault(),e.stopPropagation(),g=b.length;var f=a(this),h=f.find(".spinner"),i=a("#mesh-sections-container");return f.hasClass("disabled")?!1:(c.disable_controls(m),f.addClass("active"),h.addClass("is-active"),void a.post(ajaxurl,{action:"mesh_add_section",mesh_post_id:mesh_data.post_id,mesh_section_count:g,mesh_add_section_nonce:mesh_data.add_section_nonce},function(e){if(e){var g=a(e),j=g.find(".wp-editor-area"),k=a(".empty-sections-message"),l=a(".mesh-main-ua-row");n.append(g),h.removeClass("is-active"),f.removeClass("active"),k.length&&(k.fadeOut("fast").promise(function(){a("#description-wrap").remove()}),l.fadeIn("fast")),d.rerender_blocks(j),b=a(".mesh-section",n);var o=g.find(".handlediv");o.attr("aria-expanded",!0).on("click",c.toggle_collapse),setTimeout(function(){mesh.pointers.show_pointer()},250),c.enable_controls(m),m.trigger("mesh:add_section")}else h.removeClass("is-active");var p=a(window).height()+a(window).scrollTop(),q=i.offset().top+i.outerHeight(!0),r=.5*(q-p);1e3>r&&(r=1e3),r>3e3&&(r=3e3),a("html, body").animate({scrollTop:i.offset().top+i.outerHeight(!0)-a(window).height()},r)}))},section_publish:function(b){b.preventDefault(),b.stopPropagation();var c=a(this).closest(".mesh-section"),d=a(".mesh-section-status",c),e=a(".mesh-section-status-text",c),f=a(".mesh-section-update",c);d.val("publish"),e.text(mesh_data.strings.published),f.trigger("click")},section_save_draft:function(b){b.preventDefault(),b.stopPropagation();var c=a(this).closest(".mesh-section"),d=a(".mesh-section-update",c);d.trigger("click")},section_save:function(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=c.parent(),e=d.find(".spinner"),f=d.find(".saved-status-icon"),g=c.closest(".mesh-section"),h=g.find(".mesh-section-status"),i=g.attr("data-mesh-section-id");g.find(".mesh-editor-blocks .wp-editor-area").each(function(){var b="",c=a(this).attr("id"),d=tinymce.get(c);d&&!d.hidden&&(b=d.getContent(),a("#"+c).val(b))});var j=g.parents("form").serialize();d.find(".button").addClass("disabled"),e.addClass("is-active"),a.post(ajaxurl,{action:"mesh_save_section",mesh_section_id:i,mesh_section_data:j,mesh_post_type:mesh_data.post_type,mesh_save_section_nonce:mesh_data.save_section_nonce},function(b){var c=d.find(".button");if(c.removeClass("disabled"),e.removeClass("is-active"),f.addClass("is-active").delay(2e3).queue(function(){a(this).removeClass("is-active").dequeue()}),b){var i=g.find(".mesh-section-publish, .mesh-section-save-draft");"publish"==h.val()?(c.removeClass("hidden"),i.addClass("hidden")):(c.addClass("hidden"),i.removeClass("hidden"))}})},remove_section:function(b){b.preventDefault(),b.stopPropagation();var c=confirm(mesh_data.strings.confirm_remove);if(c){var d=a(this),e=d.parents(".mesh-postbox"),f=a(".mesh-add-spinner",e),g=e.attr("data-mesh-section-id");f.addClass("is-active"),a.post(ajaxurl,{action:"mesh_remove_section",mesh_post_id:mesh_data.post_id,mesh_section_id:g,mesh_remove_section_nonce:mesh_data.remove_section_nonce},function(b){if("1"===b)e.fadeOut(400,function(){e.remove();var a=m.find(".mesh-section");a.length<=1&&i.addClass("disabled")});else if("-1"===b)console.log("There was an error");else{var c=a(b),d=a(".mesh-main-ua-row"),g=a("#mesh-description");-1===b.indexOf("mesh-empty-actions")&&n.append(c),e.fadeOut(400,function(){e.remove(),b.indexOf("mesh-empty-actions")>0&&g.html("").append(c).show()}),d.fadeOut("fast"),f.removeClass("is-active")}})}},reorder_sections:function(b){b.preventDefault(),b.stopPropagation();var d=a(this);d.hasClass("disabled")||(c.disable_controls(m),m.addClass("mesh-is-ordering"),i.text(mesh_data.strings.save_order).addClass("mesh-save-order button-primary").removeClass("mesh-section-reorder"),c.collapse_all_sections(),n.sortable())},update_notifications:function(a,b){o.removeClass("notice-info notice-warning notice-success").addClass("notice-"+b).find("p").text(mesh_data.strings[a]),o.is(":visible")||o.css({opacity:0}).show(),o.fadeIn("fast")},save_section_order_sortable:function(b,c){var d=a(".mesh-reorder-spinner"),e=[];d.addClass("is-active"),a(".mesh-postbox",n).each(function(b){var c=a(this);e.push(c.attr("data-mesh-section-id")),c.find(".section-menu-order").val(b)})},save_section_order:function(b){b.preventDefault(),b.stopPropagation();var d=(a(this),a(".mesh-reorder-spinner")),e=[];d.addClass("is-active"),m.removeClass("mesh-is-ordering"),c.enable_controls(m),i.text(mesh_data.strings.reorder).addClass("mesh-section-reorder").removeClass("mesh-save-order button-primary"),a(".mesh-postbox",n).each(function(b){var c=a(this);e.push(c.attr("data-mesh-section-id")),c.find(".section-menu-order").val(b)}),o.is(":visible")&&o.removeClass("notice-warning").addClass("notice-info").find("p").text(mesh_data.strings.description),c.save_section_ajax(e,d),n.sortable("destroy")},save_section_ajax:function(b,c){a.post(ajaxurl,{action:"mesh_update_order",mesh_post_id:parseInt(mesh_data.post_id),mesh_section_ids:b,mesh_reorder_section_nonce:mesh_data.reorder_section_nonce},function(a){c.removeClass("is-active")})},change_input_title:function(b){var c=a(this);if(!c.parents(".mesh-postbox").hasClass("closed")){var d=c.val(),e=c.siblings(".handle-title");c.is("select")||((""===d||"undefined"==d)&&(d=mesh_data.strings.default_title),e.text(d))}},change_select_title:function(b){var c=a(this),d=c.val(),e=c.siblings(".handle-title");switch(d){case"publish":d=mesh_data.strings.published;break;case"draft":d=mesh_data.strings.draft}e.text(d)},prevent_submit:function(b){return 13==b.keyCode?(a(this).siblings(".close-title-edit").trigger("click"),b.preventDefault(),!1):void 0},block_click:function(a){a.stopImmediatePropagation()},remove_background:function(b){b.preventDefault(),b.stopPropagation();var c=a(this);c.prev().hasClass("right")&&!c.prev().hasClass("button")&&(c.parents(".block-background-container")?c.prev().toggleClass("right").attr("data-mesh-block-featured-image",""):c.prev().toggleClass("button right")),c.siblings('input[type="hidden"]').val(""),c.prev().text(mesh_data.strings.add_image),c.remove()},choose_background:function(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=c.parents(".mesh-postbox"),e=parseInt(d.attr("data-mesh-section-id")),f="mesh-background-select-"+e,g=c.attr("data-mesh-section-featured-image");return q[f]?(q[f].uploader.uploader.param("mesh_upload","true"),void q[f].open()):(q[f]=wp.media.frames.media_frames=wp.media({className:"media-frame mesh-media-frame",frame:"select",multiple:!1,title:mesh_data.strings.select_section_bg,button:{text:mesh_data.strings.select_bg}}),q[f].on("open",function(){var a=q[f].state().get("selection");a.add(wp.media.attachment(g))}),q[f].on("select",function(){var b=q[f].state().get("selection").first().toJSON(),d=(a("<span />",{"class":"dashicons dashicons-edit"}),a("<a/>",{"data-mesh-section-featured-image":"",href:"#","class":"mesh-featured-image-trash dashicons-before dashicons-dismiss"}));g=b.id;var e=a("<img />",{src:b.url});c.html(e).attr("data-mesh-section-featured-image",parseInt(b.id)).after(d),c.siblings('input[type="hidden"]').val(b.id),c.hasClass("button")&&!c.hasClass("right")&&c.toggleClass("button right")}),void q[f].open())},mesh_equalize:function(){var b=a(this),c=a("[data-equalizer-watch]",b),d=0;c.each(function(){var b=a(this).height();d=b>d?b:d}).height(d)},trash_extra_blocks:function(b){b.preventDefault(),b.stopPropagation();var d=a(this),e=d.parents(".mesh-postbox"),f=e.attr("data-mesh-section-id");c.disable_controls(e),a.post(ajaxurl,{action:"mesh_trash_hidden_blocks",mesh_post_id:mesh_data.post_id,mesh_section_id:f,mesh_choose_layout_nonce:mesh_data.choose_layout_nonce},function(a){if("1"===a){var b=e.find(".description.notice");b.fadeOut(400,function(){b.remove()})}else"-1"===a&&console.log("There was an error");c.enable_controls(e)})},disable_controls:function(b){l.addClass("disabled"),j.addClass("disabled"),k.addClass("disabled"),i.addClass("disabled");var c=a(".mesh-section",n);c.length>1&&i.removeClass("disabled"),a(".disabled-overlay").remove(),b.find(".inside").css("position","relative").prepend('<div class="disabled-overlay" />')},enable_controls:function(b){l.removeClass("disabled"),j.removeClass("disabled"),k.removeClass("disabled");var c=a(".mesh-section",m);c.length>1?i.removeClass("disabled"):i.addClass("disabled"),b.find(".inside").find(".disabled-overlay").remove()},display_foundation_options:function(b){var c=a("#mesh-css_mode").find("option:selected").val(),d=a("#mesh-foundation_version"),e=d.closest("tr");1===parseInt(c)?e.show():(e.hide(),d.val(""))}}}(jQuery),jQuery(function(a){mesh.admin.init()});